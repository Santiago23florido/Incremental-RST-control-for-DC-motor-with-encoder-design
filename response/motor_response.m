% Datos
tiempo = [30300,30400,30500,30600,30700,30800,30900,31000,...
          31100,31200,31300,31400,31500,31600,31700,31800,31900,32000,...
          32100,32200,32300,32400,32500,32600,32700,32800,32900,33000,...
          33100,33200,33300,33400,33500,33600,33700,33800,33900,34000,...
          34100,34200,34300,34400,34500,34600,34700,34800,34900,35000,...
          35100,35200,35300,35400,35500,35600,35700,35800,35900,36000,...
          36100,36200,36300,36400,36500,36600,36700,36800,36900,37000,...
          37100,37200,37300,37400,37500,37600,37700,37800,37900,38001]/1000-30.3;

rpm = [0.00,6.46,22.27,33.62,36.34,38.86,39.97,41.50,...
       42.02,42.20,40.91,41.22,40.59,41.84,40.82,40.84,39.39,41.32,...
       40.58,43.36,41.35,40.15,39.72,40.86,42.38,41.54,42.38,40.73,...
       41.49,40.75,42.44,41.44,41.58,41.36,40.97,41.28,40.83,40.35,...
       41.48,39.26,39.38,41.57,42.01,42.29,39.48,40.66,40.28,41.49,...
       42.00,41.17,40.59,40.27,41.06,41.28,42.97,41.81,42.14,40.08,...
       41.73,43.50,41.85,40.00,39.37,40.96,41.07,41.78,41.01,39.40,...
       41.52,42.23,41.65,41.73,41.71,39.57,41.49,43.96,42.11,38.37];

% Graficar
figure;
plot(tiempo, rpm, 'k-', 'LineWidth', 1.5); hold on;
plot(tiempo, 40*ones(size(tiempo)), 'k--', 'LineWidth', 1.5); % Setpoint en rojo punteado
ylim([0,60])
xlabel('Time (s)');
ylabel('RPM');
legend('RPM', 'Setpoint (40 RPM)');
grid on;
%%
% Datos
tiempo = [0,100,200,300,400,500,600,700,800,900,1000,...
          1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,...
          2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,...
          3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,...
          4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,...
          5100,5200,5300,5400,5500,5600,5700,5800,5900,6000,...
          6100,6200,6300,6400,6500,6600,6700,6800,6900,7000]/1000;

rpm = [0,2.18,14.18,21.44,26.63,26.15,27.01,26.19,26.85,27.03,27.94,...
       27.55,27.52,32.22,31.65,30.17,29.96,31.80,31.31,30.64,31.26,...
       31.13,30.18,30.68,30.45,31.38,30.54,31.55,30.17,28.95,30.28,...
       30.82,30.88,30.76,31.20,30.87,31.88,30.93,30.45,31.27,31.92,...
       31.25,30.90,32.00,30.48,30.02,30.39,30.41,31.85,30.98,32.10,...
       30.62,29.69,30.95,30.45,30.91,31.04,30.64,30.56,30.94,29.93,...
       30.54,30.76,31.71,31.45,30.07,30.52,30.30,30.51,30.79,30.81];

% Setpoint
setpoint = 30;

% Graficar
figure;
plot(tiempo, rpm, 'k-', 'LineWidth', 1.5); hold on;
plot(tiempo, 30*ones(size(tiempo)), 'k--', 'LineWidth', 1.5); % Setpoint en rojo punteado
ylim([0,60])
xlabel('Time (s)');
ylabel('RPM');
legend('RPM', 'Setpoint (30 RPM)');
grid on;
%%
% Datos nuevos
tiempo = [0,100,200,300,400,500,600,700,800,900,1000,...
          1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,...
          2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,...
          3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,...
          4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,...
          5100,5200,5300,5400,5500,5600,5700,5800,5900,6000]/1000;

rpm = [0,1.46,9.11,14.16,17.05,17.82,17.35,18.25,17.80,17.62,18.27,...
       18.02,18.08,18.72,18.90,18.74,18.76,21.60,20.78,20.26,20.14,...
       20.71,20.51,21.39,20.80,20.95,20.79,20.69,20.64,20.42,20.46,...
       20.75,20.59,20.93,21.29,21.50,21.09,20.91,20.82,20.71,20.59,...
       20.26,20.15,20.37,20.63,21.92,20.86,20.26,21.16,20.34,19.92,...
       19.87,20.45,20.27,19.96,21.14,20.62,21.17,20.94,20.64,20.68];

% Setpoint (ajusta si es necesario)
setpoint = 20;

% Graficar
figure;
plot(tiempo, rpm, 'k-', 'LineWidth', 1.5); hold on;
plot(tiempo, setpoint*ones(size(tiempo)), 'k--', 'LineWidth', 1.5);

xlabel('Time (ms)');
ylabel('RPM');
legend('RPM ', sprintf('Setpoint (20 RPM)', setpoint));
grid on;
